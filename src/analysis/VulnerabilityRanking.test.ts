import { describe, it, expect } from 'vitest';
import { calculateVulnerabilityScore, VulnerabilityContext } from './VulnerabilityRanking';

describe('calculateVulnerabilityScore', () => {
  it('computes score with default weights', () => {
    const ctx: VulnerabilityContext = {
      assetValue: 5,
      exploitability: 7,
      lateralMovement: 3,
      activeExploitation: true
    };
    const score = calculateVulnerabilityScore(ctx);
    expect(score).toBe(5 + 7 + 3 + 20); // active exploitation adds 20
  });
});
